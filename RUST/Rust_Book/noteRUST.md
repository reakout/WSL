# `RUST`æƒå¨æŒ‡å—è¯»ä¹¦ç¬”è®°

[TOC]

## Char3 é€šç”¨ç¼–ç¨‹æ¦‚å¿µ

### å˜é‡ä¸å¯å˜æ€§

#### å˜é‡

ç”¨letå£°æ˜çš„å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚ä»¥ä¸‹ä¼šæŠ¥é”™

```rust
fn main() {
    let x = 5;
    println!("The value of x is: {}", x);
    x = 6;
    println!("The value of x is: {}", x);
}
```

å¦‚æœæƒ³è¦æ”¹å˜å€¼çš„è¯ï¼Œéœ€è¦å£°æ˜æ—¶åŠ ä¸Š`mut`

`let mut x = 5;`

#### å¸¸é‡

`const`å…³é”®å­—ï¼Œä¸å…è®¸ä½¿ç”¨`mut`ä¹Ÿä¸èƒ½ä¿®æ”¹å€¼ï¼Œåªèƒ½è®¾ç½®ä¸º**å¸¸é‡è¡¨è¾¾å¼**ï¼Œä¸”**ç±»å‹å¿…é¡»æ³¨æ˜**ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨å‡½æ•°è°ƒç”¨ç»“æœæˆ–è€…è¿è¡Œæ—¶ç»“æœ

å¸¸é‡å‘½ååº”è¯¥ç”¨å…¨å¤§å†™åŠ ä¸‹åˆ’çº¿ï¼Œå¦‚ä¸‹:

`const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;`

#### é®è”½

å¯ä»¥ç”¨`let`é‡å¤ä½¿ç”¨ç›¸åŒçš„å˜é‡åæ¥é®è”½å˜é‡ï¼Œå¦‚

```rust
fn main() {
    let x = 5;

    let x = x + 1;

    {
        let x = x * 2;
        println!("The value of x in the inner scope is: {}", x);
    }

    println!("The value of x is: {}", x);
}
```

å¤–å±‚ä½œç”¨åŸŸé‡Œé®è”½ä¸€æ¬¡ï¼Œå†…å±‚ä½œç”¨åŸŸé‡Œé®è”½ä¸€æ¬¡ï¼Œä½†ä¼ ä¸å‡ºæ¥ï¼Œæ‰€ä»¥ä¸¤æ¬¡è¾“å‡ºç»“æœåº”è¯¥æ˜¯12å’Œ6

é®è”½å¯ä»¥å®Œæˆä¸€äº›å€¼çš„è½¬æ¢ï¼Œä½†å®Œæˆä¹‹åè¿˜æ˜¯ä¸å¯å˜çš„

ä¸`mut`çš„åŒºåˆ«ï¼Œç”¨`let`æœ¬è´¨æ˜¯å†åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œä½†æ˜¯é‡å¤ä½¿ç”¨äº†ç›¸åŒçš„åç§°ï¼Œå› æ­¤ç”¨`let`é®è”½å¯ä»¥åŒåæ¢ç±»å‹ï¼Œä½†`mut`ä¸å…è®¸æ›´æ”¹ç±»å‹ï¼Œå¦‚

```rust
fn main() {
    let spaces = "   ";
    let spaces = spaces.len();
}
```

```rust
fn main() {
    let mut spaces = "   ";
    spaces = spaces.len();
}
```

ç¬¬ä¸€ä¸ªokç¬¬äºŒä¸ªæŠ¥é”™ã€‚

### æ•°æ®ç±»å‹

`rust`æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œå³éœ€è¦åœ¨ç¼–è¯‘å™¨è€Œéè¿è¡Œæ—¶å¾—åˆ°æ‰€æœ‰çš„å˜é‡ç±»å‹

#### æ ‡é‡ç±»å‹

è¡¨ç¤ºå•ä¸ªå€¼çš„ç±»å‹ï¼ˆscalarï¼‰ï¼Œåœ¨`rust`ä¸­æœ‰æ•´å‹ã€æµ®ç‚¹ã€å¸ƒå°”å’Œå­—ç¬¦å››ç§

 ##### æ•´å‹

| é•¿åº¦   | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |
| ------ | ---------- | ---------- |
| 8 ä½   | `i8`       | `u8`       |
| 16 ä½  | `i16`      | `u16`      |
| 32 ä½  | `i32`      | `u32`      |
| 64 ä½  | `i64`      | `u64`      |
| 128 ä½ | `i128`     | `u128`     |
| arch   | `isize`    | `usize`    |

`isize`å’Œ`usize`å–å†³äºç³»ç»Ÿæ¶æ„ï¼Œ64ä½åˆ™æ˜¯64ä½ï¼Œ32ä½åˆ™32ä½

å¯èƒ½å±äºå¤šä¸ªæ•°å­—ç±»å‹çš„æ•°å­—å­—é¢å€¼å…è®¸ä½¿ç”¨ç±»å‹åç¼€æŒ‡å®šç±»å‹ï¼Œå¦‚`58u8`ã€‚æ•°å­—å­—é¢å€¼è¿˜å¯ä»¥ç”¨`_`ä½œä¸ºä¸å½±å“å¤§å°å’Œæ­£ç¡®æ€§çš„å¯è§†åˆ†å‰²ç¬¦ï¼Œå¦‚`1_000`

ä¸åŒè¿›åˆ¶è¿˜å¯ä»¥ç›´æ¥ç”¨äºå­—é¢é‡èµ‹å€¼

| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |
| ------------------ | ------------- |
| åè¿›åˆ¶             | `98_222`      |
| åå…­è¿›åˆ¶           | `0xff`        |
| å…«è¿›åˆ¶             | `0o77`        |
| äºŒè¿›åˆ¶             | `0b1111_0000` |
| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |

**æ•´å½¢é»˜è®¤æ˜¯`i32`**

è¶…å‡ºäº†è¡¨ç¤ºèŒƒå›´æ—¶ä¼šå‘ç”Ÿæ•´å‹æº¢å‡ºï¼Œåœ¨debugç‰ˆæœ¬ä¼šæ£€æŸ¥æ•´å‹æº¢å‡ºï¼ˆhowï¼Ÿï¼Ÿè¿™éœ€è¦è¿è¡Œæ—¶è¿›è¡Œå•Šï¼‰å¦‚æœå‘ç°å­˜åœ¨ï¼Œåˆ™ä¼šæŠ¥panicé€€å‡ºï¼Œpanicå®é™…ä¸Šå°±æ˜¯è¿è¡Œæ—¶çš„æ“ä½œã€‚åœ¨releaseç‰ˆæœ¬ä¸ä¼šè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæº¢å‡ºä¼šè¿›è¡Œtwo's complement srappingäºŒè¿›åˆ¶è¡¥ç åŒ…è£¹ï¼ˆæ¯”å¦‚255ä¸Šé™æ—¶å¯¹åº”256ä¼šæº¢å‡ºæˆ0ï¼Œç±»ä¼¼ä¸€ä¸ªå¾ªç¯é˜Ÿåˆ—ï¼‰

##### æµ®ç‚¹ç±»å‹

`rust`ä¸­çš„æµ®ç‚¹ç±»å‹æœ‰`f32`å’Œ`f64` ä¸¤ç±»ï¼Œé»˜è®¤ä¸º`f64`ï¼Œå› ä¸ºé€Ÿåº¦ä¸`f32`å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ï¼Œæ‰€æœ‰æµ®ç‚¹æ•°éƒ½æœ‰ç¬¦å·

é‡‡ç”¨`IEEE-754`æ ‡å‡†ï¼Œ`f32`æ˜¯å•ç²¾åº¦æµ®ç‚¹å‹`f64`æ˜¯åŒç²¾åº¦æµ®ç‚¹å‹

##### æ•°å­—è¿ç®—

æ”¯æŒåŠ å‡ä¹˜é™¤å–æ¨¡ï¼Œä¸”æ•´æ•°é™¤æ³•å‘ä¸‹å–æ•´

##### å¸ƒå°”ç±»å‹

`bool`å¤§å°1Byteï¼Œå–å€¼`true`å’Œ`false`

##### å­—ç¬¦ç±»å‹

`char`  è·Ÿcppç±»ä¼¼ï¼Œå­—ç¬¦ç”¨å•å°å·ï¼Œå­—ç¬¦ä¸²ç”¨åŒå¼•å·

`rust`çš„å­—ç¬¦ç±»å‹å¤§å°ä¸º4Byteï¼Œé‡‡ç”¨Unicodeæ ‡é‡ï¼Œä¸€ä¸ªå­—èŠ‚å¯ä»¥å®¹çº³èŒƒå›´è¿œè¶…ASCIIï¼Œæ¯”å¦‚å¯ä»¥æ”¾ä¸‹emoji ğŸ˜

##### å¤åˆç±»å‹

å¤åˆç±»å‹æŒ‡çš„æ˜¯æŠŠå¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚`rust`ä¸¤ç§åŸºæœ¬çš„ç¬¦åˆç±»å‹æ˜¯å…ƒç»„å’Œæ•°ç»„

###### å…ƒç»„

å¤šç§ç±»å‹çš„å¤šä¸ªå€¼æ”¾åˆ°ä¸€ä¸ªå¤åˆç±»å‹ä¸­ï¼Œ**é•¿åº¦å›ºå®š**ï¼Œè¯­æ³•æ˜¯åœ¨å°æ‹¬å·ä¸­ç”¨é€—å·é—´éš”

å¦‚`let tup: (i32, f64, u8) = (500, 6.4, 1)`

æƒ³è¦ä»å…ƒç»„ä¸­å–å€¼éœ€è¦ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥è§£æ„ï¼ˆç±»ä¼¼pythonå†™æ³•ï¼‰

```rust
fn main() {
    let tup = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of y is: {}", y);
}
```

ä¹Ÿå¯ä»¥æŒ‰é¡ºåºç”¨ç´¢å¼•åŠ `.`å–å¾—ï¼Œä¸‹æ ‡ä»**0**å¼€å§‹ï¼Œå¦‚å–`f64`ç±»å‹çš„å…ƒç´ åº”è¯¥ä½¿ç”¨`tup.1`

ç©ºå…ƒç»„æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹ï¼Œä¹Ÿå†™æˆ`()`ï¼Œè¢«ç§°ä¸º**å•å…ƒç±»å‹**ï¼Œè¯¥å€¼è¢«ç§°ä¸º**å•å…ƒå€¼**ã€‚å¦‚æœè¡¨è¾¾å¼éƒ¨è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œå°±**éšå¼è¿”å›å•å…ƒå€¼**



###### æ•°ç»„

æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å¿…é¡»æœ‰ç›¸åŒç±»å‹ï¼Œä¸”`rust`ä¸­çš„æ•°ç»„ä¹Ÿæ˜¯**å®šé•¿**çš„ï¼Œä½¿ç”¨æ–¹æ³•æ˜¯åœ¨æ–¹æ‹¬å·ä¸­ç”¨é€—å·åˆ†å‰²å®šä¹‰ã€‚å¦‚`let a = [1, 2, 3, 4]`

æ•°ç»„ä¸€èˆ¬ç”¨äºéœ€è¦å°†æ•°æ®åˆ†é…åˆ°**æ ˆè€Œéå †**æ—¶ï¼Œ`rust`ä¸­ä¹Ÿæœ‰`vector`ï¼Œåº”ä¼˜å…ˆä½¿ç”¨`vector`

ä¹Ÿå¯ä»¥æ˜¾å¼æŒ‡å®šç±»å‹å’Œé•¿åº¦å®šä¹‰æ•°ç»„ï¼Œå¦‚`let a: [i32; 5] = [1, 2, 3, 4, 5]`

å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½ç›¸åŒï¼Œå¯ä»¥ç›´æ¥å€¼å’Œä¸ªæ•°å®šä¹‰ï¼Œå¦‚`let a = [3; 5]`å®šä¹‰äº†5ä¸ª3ç»„æˆçš„æ•°ç»„ï¼ˆç€ä¸€å—å’Œmatlabè¯­æ³•å¾ˆåƒã€‚

æ•°ç»„çš„å…ƒç´ è®¿é—®ç”¨`[]`

åœ¨è¿è¡Œæ—¶è®¿é—®è¶…å‡ºèŒƒå›´çš„å€¼æ—¶ä¼š`panic`è€Œä¸æ˜¯åƒCä¸€æ ·ç¨€é‡Œç³Šæ¶‚è¿è¡Œç€ã€‚



### å‡½æ•°

`main`å‡½æ•°æ˜¯ç¨‹åºå…¥å£ç‚¹ï¼Œ`rust`ä¸­å‡½æ•°ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•ï¼Œå³æ‰€æœ‰å­—æ¯éƒ½æ˜¯å°å†™çš„å¹¶ä¸”ç”¨ä¸‹åˆ’çº¿æ¥åˆ†å‰²å•è¯ã€‚`rust`ä¸åœ¨æ„å‡½æ•°å®šä¹‰ä½ç½®ï¼Œåªè¦å®šä¹‰è¿‡å°±è¡Œã€‚

å‡½æ•°å¿…é¡»å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹(ç±»ä¼¼c/cpp)ï¼Œå¤šä¸ªå‚æ•°æ—¶ç”¨é€—å·åˆ†éš”ã€‚

#### è¯­å¥å’Œè¡¨è¾¾å¼

å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œä½†ä¹Ÿå¯ä»¥é€‰æ‹©ç”¨è¡¨è¾¾å¼ç»“å°¾ã€‚`rust`æ˜¯ä¸€é—¨ç‰¹åˆ«çš„**åŸºäºè¡¨è¾¾å¼**çš„è¯­è¨€ï¼Œé€‰æ‹©è¯­å¥æˆ–è€…è¡¨è¾¾å¼å°†ä¼šå½±å“åˆ°å‡½æ•°ä½“ã€‚

**è¯­å¥**(statement)æ‰§è¡Œæ“ä½œä½†ä¸è¿”å›å€¼ã€‚å¦‚`let y = 6;`

**è¡¨è¾¾å¼**(expression)è®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œè¯­å¥ä¸­çš„ä¸€éƒ¨åˆ†ä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ä¸Šé¢çš„`6`å°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚å‡½æ•°**è°ƒç”¨**æ˜¯è¡¨è¾¾å¼ï¼Œå®è°ƒç”¨ä¹Ÿæ˜¯è¡¨è¾¾å¼ï¼Œåˆ›å»ºæ–°ä½œç”¨åŸŸçš„å¤§æ‹¬å·`{}`ä¹Ÿæ˜¯è¡¨è¾¾å¼

å‡½æ•°**å®šä¹‰**æœ¬èº«ä¹Ÿæ˜¯è¯­å¥ã€‚å’Œcèµ‹å€¼è¯­å¥ä¸åŒï¼Œè¯­å¥æ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸èƒ½å†™è¿ç­‰å¦‚`let x = (let y = 6);`



è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚å¦‚æœåœ¨è¡¨è¾¾å¼æœ«å°¾åŠ ä¸Šåˆ†å·ï¼Œå°±ä¼šè½¬æ¢ä¸ºä¸ä¼šè¿”å›å€¼çš„è¯­å¥

```rust
fn main() {
    let y = {
        let x = 3;
        x + 1   // æ²¡æœ‰;
    };

    println!("The value of y is: {}", y);
}
```

å¦‚å…¶ä¸­yåçš„é‚£ä¸€ä¸²`{}`é‡Œçš„å°±æ˜¯è¡¨è¾¾å¼

#### å¸¦è¿”å›å€¼çš„å‡½æ•°

`rust`ä¸åƒcä¸€æ ·å†™æ˜¾å¼è¿”å›å€¼ï¼Œé»˜è®¤å¯ä»¥ç”¨éšå¼è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œå¦‚æœç”¨`return`å…³é”®å­—å’ŒæŒ‡å®šå€¼ï¼Œå¯ä»¥ä»å‡½æ•°æå‰è¿”å›ã€‚å‡½æ•°è¿”å›å€¼çš„ç±»å‹å†™åœ¨å‚æ•°åˆ—è¡¨åç”¨ `->`æ¥ç±»å‹è¡¨ç¤ºã€‚

```rust
fn five() -> i32 {
    5
}

fn main() {
    let x = five();

    println!("The value of x is: {}", x);
}
```

å¦‚æœå¸¦ä¸Šåˆ†å·ï¼Œä¼šè®©å‡½æ•°ä»è¡¨è¾¾å¼å˜æˆè¯­å¥ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼ˆå³ä¼šè¿”å›ä¸€ä¸ªç©ºå…ƒç»„ç±»å‹è¡¨ç¤ºæ²¡æœ‰è¿”å›å€¼ï¼‰ï¼Œå¯¼è‡´ç±»å‹å’Œi32ä¸åŒ¹é…æŠ¥é”™ã€‚



### æ³¨é‡Š

`rust`é€šç”¨æ³¨é‡Šæ˜¯`//`ï¼Œè¿˜æœ‰ä¸€ç§æ–‡æ¡£æ³¨é‡Šç•™å¾…ä¹‹åå†è¯´ã€‚



### æ§åˆ¶æµ

#### ifè¡¨è¾¾å¼

if elseç”¨æ³•ç±»ä¼¼cä¸­ï¼Œä½†æ˜¯ifåå¿…é¡»æ˜¯ä¸€ä¸ª`bool`ç±»å‹çš„è¡¨è¾¾å¼ï¼Œ`rust`ä¸ä¼šè‡ªåŠ¨æŠŠéå¸ƒå°”å€¼è½¬æ¢æˆå¸ƒå°”å€¼ã€‚

åœ¨å¤šä¸ªifä¸²else ifä¸­ä¼šæ£€æµ‹ç¬¬ä¸€ä¸ªä¸ºçœŸçš„ifæ¡ä»¶æ‰§è¡Œ

##### letä¸­ä½¿ç”¨if

ç±»ä¼¼äºcppä¸­çš„ä¸‰ç›®è¿ç®—ç¬¦ ?:

å¦‚

```rust
fn main() {
    let condition = true;
    let number = if condition { 5 } else { 6 };

    println!("The value of number is: {}", number);
}
```

ifè¡¨è¾¾å¼åœ¨ifåˆ†æ”¯å’Œelseåˆ†æ”¯çš„ç»“æœå¿…é¡»æ˜¯ç›¸åŒç±»å‹ï¼Œä¸åŒ¹é…çš„è¯ä¼šæŠ¥é”™ã€‚

#### å¾ªç¯

`rust`æœ‰ä¸‰ç§å¾ªç¯ï¼Œ`loop` `while` `for`

##### loop

æ— æ¡ä»¶å¾ªç¯ï¼Œå¯ç”¨continueå’Œbreakè·³å‡ºï¼Œä½¿ç”¨æ—¶å¯ä»¥å¸¦ä¸Šå¾ªç¯æ ‡ç­¾ï¼ˆ`loop label`ï¼‰é…åˆä½¿ç”¨æ¥è·³å‡ºæŒ‡å®šçš„å¾ªç¯è€Œéé»˜è®¤çš„å†…å±‚å¾ªç¯

```rust
// æ— æ§åˆ¶loop
fn main() {
    loop {
        println!("again!");
    }
}
```

```rust
// å¸¦æ§åˆ¶loop
fn main() {
    let mut count = 0;
    'counting_up: loop {
        println!("count = {}", count);
        let mut remaining = 10;

        loop {
            println!("remaining = {}", remaining);
            if remaining == 9 {
                break;
            }
            if count == 2 {
                break 'counting_up;
            }
            remaining -= 1;
        }

        count += 1;
    }
    println!("End count = {}", count);
}
```

##### while

ç”¨æ³•ç±»ä¼¼cï¼Œä¸è¿‡æ¡ä»¶ä¸ç”¨æ‰“æ‹¬å·ï¼Œä¸”å¿…é¡»ä¸º`bool`ç±»å‹

##### for

`rust`ä¸­çš„forå¾ªç¯å¯ä»¥å®ç°ç±»ä¼¼`python`ä¸­ç”¨æ³•ï¼Œä¸»è¦ç”¨äºéå†æ—¶æœ‰æ•ˆé¿å…`panic`

```rust
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("the value is: {}", element);
    }
}
```

ä¸€ä¸ªåè½¬åŒºé—´å€’è®¡æ—¶çš„ä¾‹å­

```rust
fn main() {
    for number in (1..4).rev() {
        println!("{}!", number);
    }
    println!("LIFTOFF!!!");
}
```

ä»¥ä¸Šä»£ç ä¸­revæ˜¯åè½¬æ–¹æ³•ã€‚



## Char4 æ‰€æœ‰æƒ

